<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>TÃ¼rkel Admin Panel</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <!-- TÃ¼rkel Admin Header -->
  <div id="turkel-header" style="background: #CE1A28; color: white; padding: 12px 24px; display: flex; align-items: center; justify-content: space-between; position: fixed; top: 0; left: 0; right: 0; z-index: 10000; height: 50px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <div style="display: flex; align-items: center; gap: 12px;">
      <div style="background: white; color: #CE1A28; padding: 6px 12px; border-radius: 6px; font-weight: bold; font-size: 16px;">TÃœRKEL</div>
      <span style="font-weight: 600; font-size: 18px;">Admin Panel</span>
    </div>
    <div style="font-size: 14px; opacity: 0.95;">
      <span id="user-email">Admin User</span>
      <button onclick="window.netlifyIdentity?.logout()" style="margin-left: 16px; background: rgba(255,255,255,0.2); border: none; color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 500;">Ã‡Ä±kÄ±ÅŸ</button>
    </div>
  </div>
  
  <!-- CMS Container -->
  <div id="cms-wrapper" style="margin-top: 50px; height: calc(100vh - 50px); width: 100vw; display: flex;">
    <!-- CMS will load here -->
  </div>

  <!-- Include Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <!-- Identity and CMS Setup -->
  <script>
    // Clear caches for fresh start
    if ('caches' in window) {
      caches.keys().then(names => names.forEach(name => caches.delete(name)));
    }
    localStorage.clear();
    sessionStorage.clear();

    // Netlify Identity Setup
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        } else {
          // Update user email in header
          document.getElementById('user-email').textContent = user.email;
        }
      });
      
      window.netlifyIdentity.on("login", user => {
        // Security check
        const allowedEmails = [
          'turkelwebsite@gmail.com',
          'admin@turkel.com.tr',
          'sezani991@gmail.com'
        ];
        
        if (!allowedEmails.includes(user.email)) {
          alert('Bu email ile admin paneline eriÅŸim yetkiniz yok!');
          window.netlifyIdentity.logout();
          window.location.href = '/';
          return;
        }
        
        // Update header and close widget
        document.getElementById('user-email').textContent = user.email;
        window.netlifyIdentity.close();
        console.log("âœ… Admin login successful:", user.email);
      });
    }
    
    // CMS Styling after load
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ðŸŽ¯ Setting up TÃ¼rkel CMS styling...');
      
      setTimeout(() => {
        // Apply custom styling to CMS
        const style = document.createElement('style');
        style.textContent = `
          /* TÃœRKEL CMS CUSTOM STYLING */
          
          /* Main CMS App Container */
          [data-testid="cms-app"] {
            width: 100% !important;
            height: 100% !important;
            display: flex !important;
            background: #f8f9fa !important;
          }
          
          /* Sidebar Navigation */
          [class*="AppSidebar"],
          [class*="Sidebar"] {
            width: 350px !important;
            min-width: 350px !important;
            background: #2c3e50 !important;
            border-right: 3px solid #CE1A28 !important;
            color: white !important;
          }
          
          /* Main Content Area */
          [class*="AppMainContainer"],
          [class*="MainContainer"] {
            flex: 1 !important;
            background: white !important;
            padding: 0 !important;
          }
          
          /* Collection List Items */
          [class*="AppSidebar"] a,
          [class*="Sidebar"] a {
            color: white !important;
            padding: 16px 24px !important;
            display: block !important;
            text-decoration: none !important;
            border-bottom: 1px solid rgba(255,255,255,0.1) !important;
            font-size: 15px !important;
            font-weight: 500 !important;
            transition: all 0.2s ease !important;
          }
          
          [class*="AppSidebar"] a:hover,
          [class*="Sidebar"] a:hover {
            background: #34495e !important;
            padding-left: 32px !important;
          }
          
          /* Collection Headers */
          [class*="CollectionTop"] {
            background: #CE1A28 !important;
            color: white !important;
            padding: 24px 32px !important;
          }
          
          [class*="CollectionTop"] h1,
          [class*="CollectionTop"] h2 {
            color: white !important;
            margin: 0 !important;
            font-size: 24px !important;
            font-weight: 600 !important;
          }
          
          /* New Entry Button */
          [class*="CollectionTop"] button,
          [class*="CollectionTop"] a[href*="new"] {
            background: white !important;
            color: #CE1A28 !important;
            border: none !important;
            padding: 12px 24px !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
          }
          
          /* Entry List Container */
          [class*="EntryListing"] {
            padding: 32px !important;
            background: #f8f9fa !important;
          }
          
          /* Entry Cards */
          [class*="EntryCard"] {
            background: white !important;
            border: 1px solid #e1e5e9 !important;
            border-radius: 12px !important;
            padding: 24px !important;
            margin-bottom: 20px !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08) !important;
            transition: all 0.2s ease !important;
            cursor: pointer !important;
          }
          
          [class*="EntryCard"]:hover {
            border-color: #CE1A28 !important;
            box-shadow: 0 4px 16px rgba(206, 26, 40, 0.15) !important;
            transform: translateY(-2px) !important;
          }
          
          /* Entry Card Content */
          [class*="EntryCard"] h2,
          [class*="EntryCard"] h3 {
            color: #2c3e50 !important;
            margin: 0 0 8px 0 !important;
            font-size: 18px !important;
            font-weight: 600 !important;
          }
          
          [class*="EntryCard"] p {
            color: #7f8c8d !important;
            margin: 0 !important;
            font-size: 14px !important;
          }
          
          /* Form Editor */
          [class*="EditorContainer"] {
            background: white !important;
            padding: 32px !important;
          }
          
          /* Form Fields */
          [class*="Widget"] input,
          [class*="Widget"] textarea,
          [class*="Widget"] select {
            border: 2px solid #e1e5e9 !important;
            border-radius: 8px !important;
            padding: 12px 16px !important;
            font-size: 14px !important;
            transition: border-color 0.2s ease !important;
          }
          
          [class*="Widget"] input:focus,
          [class*="Widget"] textarea:focus,
          [class*="Widget"] select:focus {
            border-color: #CE1A28 !important;
            box-shadow: 0 0 0 3px rgba(206, 26, 40, 0.1) !important;
            outline: none !important;
          }
          
          /* Form Labels */
          [class*="Widget"] label {
            color: #2c3e50 !important;
            font-weight: 600 !important;
            margin-bottom: 8px !important;
            display: block !important;
          }
          
          /* Buttons */
          button[class*="btn"],
          [class*="Button"] {
            background: #CE1A28 !important;
            color: white !important;
            border: none !important;
            padding: 12px 24px !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: background 0.2s ease !important;
          }
          
          button[class*="btn"]:hover,
          [class*="Button"]:hover {
            background: #b01624 !important;
          }
          
          /* Custom Scrollbars */
          ::-webkit-scrollbar {
            width: 12px;
          }
          
          ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
          }
          
          ::-webkit-scrollbar-thumb {
            background: #CE1A28;
            border-radius: 6px;
          }
          
          ::-webkit-scrollbar-thumb:hover {
            background: #b01624;
          }
        `;
        document.head.appendChild(style);
        
        console.log('âœ… TÃ¼rkel CMS styling applied');
      }, 1000);
    });
  </script>
</body>
</html>